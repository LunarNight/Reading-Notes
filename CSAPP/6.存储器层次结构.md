#存储器层次结构  
 存储器系统(memory system)是一个具有不同容量,成本和访问时间的存储设备的层次结构.CPU寄存器保存着最常用的数据.靠近CPU的小的,快速的**高速缓存存储器(cache memory)**作为一部分存储在相对慢速的主存储器(main memory)中数据和指令的缓冲区域.主存缓存存储在容量较大的,慢速磁盘上的数据,这些磁盘常常又作为存储在通过网络连接的其他机器的磁盘或磁带上的数据的缓冲区域.  
 计算机系统中一个基本而持久的思想:理解系统是如何将数据在存储器层次结构中上上下下移动的,就可以编写自己的应用程序,使得它们的数据项存储在层次结构中较高的地方,在那里CPU能更快地访问到它们.  
 这个思想围绕着计算机程序的一个称为**局部性(locality)**的基本属性.具有良好局部性的程序倾向于一次又一次地**访问相同的数据项集合(时间局部性)**,或是倾向于**访问临近的数据项集合(空间局部性)**.具有良好局部性的程序比局部性差的程序更多地倾向于从存储器成此结果中较高层次处访问数据项,因此运行地更快.  
##6.1 存储技术
###6.1.1随机访问存储器
 随机访问存储器(Random-Access Memory,RAM)分为两类:静态的和动态的.静态RAM(SRAM)比动态RAM(DRAM)更快,更贵.SRAM用来作为高速缓存存储器,既可以在CPU芯片上,也可以在片下.DRAM用来作为主存图形系统的帧缓冲区.  
 **1. 静态RAM**  
 SRAM将每个位存储在一个双稳态的存储单元里.每个单元是用一个六晶体管电路来实现的.这个电路有这样一个熟悉,可以无限期地保持在两个不同的电压配置()configuration)或状态(state)之一.其他任何状态都是不稳定的.从不稳定状态开始,电路会迅速地转移到两个稳定状态中的一个.这样一个单元类似于一个**钟摆**,分为左稳态,不稳定状态(在中间),右稳态(倒向右边).原则上,钟摆能在垂直的位置无期限地保持平衡,但是这个状态是亚稳态(metastable),嘴细微的扰动也能使他倒下,而且一旦倒下就永远不会再回复到垂直的位置.  
 由于SRAM存储器单元的双稳态特性,只要有电,它就会永远地保持它的值.即使有干扰,在干扰消除时,电路就会恢复到稳定值.  
 **2. 动态RAM**  
 DRAM存储器单元对干扰非常敏感,当电容的电压扰乱之后,就永远不会恢复了.暴露在光纤瞎会导致电容电压发生改变,数码照相机和摄像机中的传感器本质上就是DRAM阵列.  
 很多原因会导致漏电,使得DRAM单元在10~100毫秒时间内失去电荷.幸运的是,计算机运行的时钟周期是以纳秒来衡量的,所以相对而言这个保持时间是比较长的.内存系统必须周期性地通过独处,然后重写来刷新内存每一位.有些系统也使用纠错码,其中计算机的字会被多编码几个位(例如64位的字可能用72位来编码),这样一来,电路可以发现并纠正一个字节中任何单个的错误位.  
 **3. 传统的DRAM**  
 DRAM芯片中的单元(位)被分成d个超单元,每个超单元都由w个DRAM单元组成.一个d x w 的 DRAM总共存储了dw位信息.超单元被组织成一个r行c列的长方形阵列,这里rc=d.每个超单元有形如(i,j)的地址,i表示行,j表示列.  
 每个DRAM芯片被连接到某个称为**内存控制器**的电路,这个电路可以一次传送w位到每个DRAM芯片或一次从每个DRAM芯片传出w位.为了读出超单元(i,j)的内容,内存控制器将行地址i发送到DRAM,然后是列地址j.DRAM把超单元(i,j)的内容发挥给控制器作为相应.行地址i称为RAS(Row Access Strobe,行访问选通脉冲)请求.列地址j称为CAS请求,RAS和CAS请求共享相同的DRAM地址引脚.  
 如果要独处超单元(2,1),内存控制器发送行地址2,DRAM的相应是将行2的整个内容都复制到一个内部行缓冲区,接下来,内存控制器发送列地址1,DRAM的相应是从行缓冲区复制出超单元(2,1)中的8位,并把它们发送到内存控制器.  
 **4. 内存模块**  
 DRAM芯片封装在**内存模块(memory module)**中,内存模块的基本思想:用8个64Mbit的 8M x 8的DRAM芯片,总共存储64MB,这8个芯片编号0~7.每个超单元存储主存的一个字节,而用相应超单元地址为(i,j)的8个超单元来表示主存中字节地址A处的64位字.DRAM0存储第一个(低位)字节,DRAM1存储下一个字节,以此类推.  
 要取出内存地址A处的一个字,内存控制器将A转换成一个超单元地址(i,j),并将它发送到内存模块,然后内存模块再将i和j广播到每个DRAM.作为相应,每个DRAM输出它的(i,j)超单元的8位内容.模块中的电路手机这些输出,并把它们合并成一个64位字,再返回给内存控制器.  
 通过将多个内存模块连接到内存控制器,能够聚合成主存.在这种情况下,当控制器收到一个地址A时,控制器选择包含A的模块k,将A转换成它的(i,j)的形式,并将(i,j)发送到模块k.  
 **5. 增强的DRAM**  
 快页模式DRAM(Fast Page Mode DRAM).传统的DRAM将超单元的一整行复制到它的内部行缓冲区中,使用一个,然后丢弃剩余的.FPM DRAM允许对同意后连续地访问可以直接从行缓冲区得到服务,从而改进了这一点.例如要从一个传统的DRAM的行i中读4个超单元,内存控制器必须发送4个RAS/CAS请求,及时是行地址i在每个情况中都是一样的.要从一个FPM DRAM的同一行中读取超单元,内存控制器发送第一个RAS/CAS请求,后面跟三个CAS请求.初始的RAS/CAS请求将行i复制到行缓冲区,并返回CAS寻址的那个超单元.接下里三个超单元直接从行缓冲区获得,因此返回得比初始的超单元更快.  
 扩展数据输出DRAM(Extended Data Out DRAM,EDO DRAM).FPM DRAM的一个增强的形式,允许各个CAS信号在时间上靠的更紧密一点.  
 同步DRAM(Synchronous DRAM,SDRAM).就它们与内存控制器通信使用一组显式的控制信号来说,常规的,FPM和EDO DRAM都是异步的.SDRAM用于驱动内存控制器相同的外部时钟信号的上升沿来替代许多这样的控制信号,最终效果就是SDRAM能够比异步的存储器更快地输出它的超单元的内容.  
 **6.非易失性存储器**  
 如果断电,DRAM和SRAM会丢失它们的信息,它们是易失的(volatile).另一方面,非易失性存储器(nonvolatile memory)即使是在观点后,仍然保存着它们的信息.现在有很多种非易失性存储器.由于历史原因,虽然ROM中有的类型即可以读也可以写,但是它们整体上都被称为只读存储器(Read-Only Memory,ROM),ROM是以它们能够被重编程(写)的次数和对它们进行重编程所用的机制来区分的.  
 PROM(Programmable ROM,可编程ROM)只能被编程一次.PROM的每个存储器单元有一种熔丝(fuse),只能用高电流熔断一次.  
 可擦写可编程ROM(Erasable Programmable ROM, EPROM).电子可擦除PROM(Electrically Erasable PROM,EEPROM)类似于EPROM.  
 闪存(falsh memory)是一类非易失性存储器,基于EEPROM,已经成为一种重要的存储技术.  
